```mermaid
flowchart TD

    %% High-level pipeline
    A[Parsed Logical Plan] --> B[Analyzed Logical Plan]
    B --> C[Optimized Logical Plan]
    C --> D[Physical Plan]

    %% Parsed
    subgraph Parsed Logical Plan
        P1["Project: COUNT(*), SUM(total_population)"]
        P2["Aggregate: BY continent"]
        P3["UnresolvedRelation: population"]
    end

    %% Analyzed
    subgraph Analyzed Logical Plan
        A1["Project: continent#12, count#45L, sum#46L"]
        A2["Aggregate: count(1), sum(total_population#13)"]
        A3["Relation: population[...]"]
    end

    %% Optimized
    subgraph Optimized Logical Plan
        O1["Aggregate: count(1), sum(total_population)"]
        O2["Project: continent, total_population"]
        O3["Relation: population"]
    end

    %% Physical
    subgraph Physical Plan
        X1["Final HashAggregate"]
        X2["Shuffle: hashpartition(continent)"]
        X3["Partial HashAggregate"]
        X4["Scan parquet population"]
    end
```
